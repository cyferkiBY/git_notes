# "Pro Git" - Scott Chacon, Ben Straub
*Notes [book](https://github.com/progit/progit2/releases/download/2.1.338/progit.pdf) by Kate Bay*

## Первоначальная настройка Git
Файл конфигурации может быть: --system (для всех пользователей), --global (на уровне пользователя), --local (по-умолчанию на уровне репо).
`git config --list --show-origin` //просмотр настроек с указанием файлов где лежат настройки
`git config --global user.name' "John Doe"` //задать имя пользователя
`git config --global user.email johndoe@example.com` //задать эмэйл
`git config --global core.editor "'C:/Program Files/Notepad++/notepad++.exe' -multiInst -notabbar -nosession -noPlugin"`  //выбор редактора для текста
`git config --global init.defaultBranch main`  //установить по-умолчанию названии ветки main вместо master для новых репо при инициализации
`git help <команда>  или git <команда> -h` - справка по команде
## Создание Git-репозитория
Репозиторий Git можно получить одним из двух способов:
1. Вы можете взять локальный каталог, который в настоящее время не находится под версионным контролем, и превратить его в репозиторий Git.
`git init` - эта команда создаёт в текущем каталоге новый подкаталог с именем .git, содержащий все необходимые файлы репозитория — структуру Git репозитория.
2. Вы можете клонировать существующий репозиторий Git из любого места.
`git clone https://github.com/libgit2/libgit2 mylibgit`
Эта команда создаёт каталог mylibgit, инициализирует в нём подкаталог .git, скачивает все данные для этого репозитория и извлекает рабочую копию последней версии
При выполнении git clone с сервера забирается (pulled) каждая версия каждого файла из истории проекта.

В Git реализовано несколько транспортных протоколов. В предыдущем примере использовался протокол https://, вы также можете встретить git:// или user@server:path/to/repo.git, использующий протокол передачи SSH.
## Запись изменений в репозиторий
Каждый файл в рабочем каталоге может находиться в одном из двух
состояний: под версионным контролем (отслеживаемые) и нет (неотслеживаемые).
*Отслеживаемые файлы (tracket) * —  это те файлы, которые были в последнем снимке состояния
проекта (это те файлы о которых знает Git); они могут быть *неизменёнными (unmodified)*, *изменёнными (modified)* или *подготовленными к коммиту (staged)*.
 *Неотслеживаемые файлы   (untracket)* —  это всё остальное, любые файлы в вашем рабочем каталоге,
которые не входили в ваш последний снимок состояния и не подготовлены к коммиту.
Когда вы впервые клонируете репозиторий, все файлы будут отслеживаемыми и
неизменёнными, потому что Git только что их извлек и вы ничего пока не редактировали.
![Рисунок 1. Жизненный цикл состояний файлов](https://git-scm.com/book/en/v2/images/lifecycle.png)
Рисунок 1. Жизненный цикл состояний файлов

`git status` //определение состояния файлов
`git add <FILE>` //сделать файл отслеживаемым (если он был новым) и добавить в индекмс (подготовленным к коммиту)
Файл попадёт в коммит в том состоянии, в котором он находился, когда вы последний раз выполняли команду git add , а не в том, в котором он находится в вашем рабочем каталоге в момент выполнения git commit. Если вы изменили файл после выполнения git add, вам придётся снова выполнить git add, чтобы проиндексировать последнюю версию файла.
## Игнорирование файлов
Для того чтобы файлы не попадали в репозиторий необходим добавить эти файлы/шаблоны в файл .gitignore. Желательно сделать это перед началом работы с проектом.
Правила шаблонов в файле .gitignore:
- Пустые строки, а также строки, начинающиеся с #, игнорируются.
- Стандартные шаблоны являются глобальными и применяются рекурсивно для всего дерева каталогов.
- Чтобы избежать рекурсии используйте символ слеш (/) в начале шаблона.
- Чтобы исключить каталог добавьте слеш (/) в конец шаблона.
- Можно инвертировать шаблон, использовав восклицательный знак (!) в качестве первого символа.

Glob-шаблоны представляют собой упрощённые регулярные выражения, используемые
командными интерпретаторами. Символ (*) соответствует 0 или более символам;
последовательность [abc] — любому символу из указанных в скобках (в данном примере a, b
или c); знак вопроса (?) соответствует одному символу; и квадратные скобки, в которые
заключены символы, разделённые дефисом ([0-9]), соответствуют любому символу из
интервала (в данном случае от 0 до 9). Вы также можете использовать две звёздочки, чтобы
указать на вложенные каталоги: a/**/z соответствует a/z, a/b/z, a/b/c/z, и так далее.

Пример файла:
```
# Исключить все файлы с расширением .a
*.a
# Но отслеживать файл lib.a даже если он подпадает под исключение выше
!lib.a
# Исключить файл TODO в корневом каталоге, но не файл в subdir/TODO
/TODO
# Игнорировать все файлы в каталоге build/
build/
# Игнорировать файл doc/notes.txt, но не файл doc/server/arch.txt
doc/*.txt
# Игнорировать все .txt файлы в каталоге doc/
doc/**/*.txt
```
## Просмотр индексированных и неиндексированных изменений
`git diff` //покажет что изменили, но пока не проиндексировали. сравнивает содержимое вашего рабочего каталога с содержимым индекса. Результат показывает ещё не проиндексированные изменения.
`git diff --staged` //что проиндексировано и что войдёт в следующий коммит. Эта команда сравнивает ваши проиндексированные изменения с последним коммитом.
`git difftool` //то же самое но просмотр с помощью предустановленной утилиты
## Коммит изменений
`git commit -m "First commit"`//коммит сохраняет снимок состояния вашего индекса
Каждый раз, когда вы делаете коммит, вы сохраняете снимок состояния вашего проекта, который позже вы можете восстановить или с которым можно сравнить текущее состояние.
